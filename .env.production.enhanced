# ProjectMeats Enhanced Production Environment Configuration
# This template addresses issues identified in the deployment delegation plan
# Copy to /etc/projectmeats/projectmeats.env for systemd service

# ==========================================
# DJANGO CORE SETTINGS - REQUIRED
# ==========================================

# CRITICAL: Set to False in production for security
DEBUG=False

# CRITICAL: Generate using: python3 -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
# Must be 50+ characters for production
SECRET_KEY=your-super-secret-production-key-change-this-immediately-50-chars-minimum

# CRITICAL: Update with your actual domains and server IP
ALLOWED_HOSTS=localhost,127.0.0.1,meatscentral.com,www.meatscentral.com,your-server-ip

# REQUIRED: Django settings module for production
DJANGO_SETTINGS_MODULE=apps.settings.production

# ==========================================
# DATABASE CONFIGURATION - REQUIRED
# ==========================================

# CRITICAL: Update with your actual database credentials
DATABASE_URL=postgres://projectmeats_user:ProjectMeats2024!@localhost:5432/projectmeats_db

# Alternative SQLite for testing (NOT recommended for production)
# DATABASE_URL=sqlite:///opt/projectmeats/backend/db.sqlite3

# ==========================================
# SECURITY SETTINGS FOR PRODUCTION
# ==========================================

# SSL/HTTPS Settings (set to False for HTTP-only environments)
SECURE_SSL_REDIRECT=False
SECURE_HSTS_SECONDS=0
SECURE_HSTS_INCLUDE_SUBDOMAINS=False
SECURE_HSTS_PRELOAD=False

# Cookie Security (adjust based on HTTPS availability)
SESSION_COOKIE_SECURE=False
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=Lax
CSRF_COOKIE_SECURE=False
CSRF_COOKIE_HTTPONLY=True
CSRF_COOKIE_SAMESITE=Lax

# Additional Security Headers
SECURE_CONTENT_TYPE_NOSNIFF=True
SECURE_BROWSER_XSS_FILTER=True
SECURE_REFERRER_POLICY=strict-origin-when-cross-origin
X_FRAME_OPTIONS=DENY

# ==========================================
# CORS CONFIGURATION FOR API ACCESS
# ==========================================

# Frontend and API access domains
CORS_ALLOWED_ORIGINS=https://meatscentral.com,https://www.meatscentral.com,http://localhost:3000,http://127.0.0.1:3000

# CSRF Protection (must match CORS origins)
CSRF_TRUSTED_ORIGINS=https://meatscentral.com,https://www.meatscentral.com,http://meatscentral.com,http://www.meatscentral.com

# ==========================================
# STATIC AND MEDIA FILES - APPROACH A
# ==========================================

# Static files served by Nginx at /django_static/
STATIC_URL=/django_static/
STATIC_ROOT=/opt/projectmeats/backend/staticfiles

# Media files served by Nginx at /media/
MEDIA_URL=/media/
MEDIA_ROOT=/opt/projectmeats/backend/media

# ==========================================
# GUNICORN CONFIGURATION
# ==========================================

# Performance tuning for Gunicorn
GUNICORN_WORKERS=3
GUNICORN_WORKER_CLASS=gthread
GUNICORN_THREADS=2
GUNICORN_WORKER_CONNECTIONS=1000
GUNICORN_TIMEOUT=120
GUNICORN_GRACEFUL_TIMEOUT=30
GUNICORN_MAX_REQUESTS=1000
GUNICORN_MAX_REQUESTS_JITTER=100
GUNICORN_BIND=127.0.0.1:8000

# ==========================================
# LOGGING CONFIGURATION
# ==========================================

# Logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Log file paths (must be writable by www-data)
DJANGO_LOG_FILE=/var/log/projectmeats/django.log
GUNICORN_ACCESS_LOG=/var/log/projectmeats/access.log
GUNICORN_ERROR_LOG=/var/log/projectmeats/error.log

# ==========================================
# DATABASE CONNECTION POOLING
# ==========================================

# Connection pooling for better performance
DB_CONN_MAX_AGE=600
DB_CONN_HEALTH_CHECKS=True

# ==========================================
# EMAIL CONFIGURATION (OPTIONAL)
# ==========================================

# Email backend for production notifications
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend

# SMTP Configuration (update with your provider)
# EMAIL_HOST=smtp.gmail.com
# EMAIL_PORT=587
# EMAIL_USE_TLS=True
# EMAIL_HOST_USER=your-email@gmail.com
# EMAIL_HOST_PASSWORD=your-app-password

# Default email addresses
# DEFAULT_FROM_EMAIL=ProjectMeats <noreply@meatscentral.com>
# SERVER_EMAIL=ProjectMeats Server <server@meatscentral.com>

# ==========================================
# CACHE CONFIGURATION (OPTIONAL)
# ==========================================

# Local memory cache for development/small deployments
CACHE_BACKEND=django.core.cache.backends.locmem.LocMemCache

# Redis cache for production (uncomment if Redis is available)
# CACHE_URL=redis://localhost:6379/1
# SESSION_ENGINE=django.contrib.sessions.backends.cache

# ==========================================
# API CONFIGURATION
# ==========================================

# API settings for DRF
API_VERSION=v1
REST_FRAMEWORK_PAGE_SIZE=20

# Rate limiting (requests per minute)
API_THROTTLE_RATE_ANON=100/hour
API_THROTTLE_RATE_USER=1000/hour

# ==========================================
# MONITORING & ERROR TRACKING
# ==========================================

# Error reporting (optional - uncomment if using Sentry)
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# Health check settings
HEALTH_CHECK_ENABLED=True

# ==========================================
# FEATURE FLAGS & BUSINESS CONFIG
# ==========================================

# Company Information
COMPANY_NAME=ProjectMeats
COMPANY_EMAIL=info@meatscentral.com

# Timezone
USE_TZ=True
TIME_ZONE=UTC

# Features
ENABLE_API_DOCS=True
ENABLE_ADMIN_DOCS=True

# PowerApps Migration Settings
POWERAPPS_MIGRATION_COMPLETE=True

# ==========================================
# BACKUP CONFIGURATION
# ==========================================

# Backup directories
BACKUP_DIR=/opt/projectmeats/backups
MEDIA_BACKUP_DIR=/opt/projectmeats/backups/media

# ==========================================
# DEVELOPMENT OVERRIDES
# ==========================================
# Uncomment these ONLY for development/staging environments

# For HTTP-only development:
# DEBUG=True
# SECURE_SSL_REDIRECT=False
# SESSION_COOKIE_SECURE=False
# CSRF_COOKIE_SECURE=False
# EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend

# For local React development:
# CORS_ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000
# CSRF_TRUSTED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# ==========================================
# VALIDATION NOTES
# ==========================================
# 
# Before deploying to production, ensure:
# 1. SECRET_KEY is changed from default
# 2. DATABASE_URL has correct credentials
# 3. ALLOWED_HOSTS includes your domain
# 4. SSL settings match your HTTPS setup
# 5. Log directories exist and are writable
# 6. Static files are collected
# 7. Database migrations are applied
#
# Test with: python manage.py check --deploy